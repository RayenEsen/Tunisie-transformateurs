<p-toast></p-toast>

<div class="speedDialContainer">
  <p-speedDial [model]="items"  direction="down"></p-speedDial>
</div>
<div #printSection class="invoice" [ngClass]="{'hover-disabled': isHoverDisabled}"  >
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
<link rel='stylesheet' href='//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css'>
<div style="display: flex;">

<img src="assets/LogoPV.png" style="width: 300px;margin-right: 23vh;" >
<img src="assets/9001ISO.png" style="width: 180px; height: 70px;"  class="printing">
<img src="assets/14001ISO-removebg-preview.png" style="width: 180px; height: 93px;">
<img src="assets/iso-45001.png" style="width: 180px; height: 147px;   ; margin-left: -27px;     margin-top: -38px; ">
<img src="assets/iso50001.png" style="width: 180px; height: 72px; ">
</div>
  <div class="invoice-header printing3">
    <div class="row">
      <div class="col-xs-8" *ngIf="pv">
        <h1>Pv d'essai <small>Transformateur</small></h1>
        <h4 class="text-muted" *ngIf="pv && pv.length > 0">
          No: {{ pv[0].id_pv }} | Date: {{ pv[0].date.toString().split('T')[0] }}
        </h4>
      </div>
    </div>
  </div>
  <div class="page-header text-blue-d2 " style=" margin: 40px 30px 20px;" >
  <div class="row" >
    <div class="col-sm-6"style=" text-align: left;">
        <div>
            <span class="text text-grey-m2 align-middle">Marque/Brand:</span>
            <span class="text-600 text-110 text-blue align-middle"> {{ service.list[0].marque }}</span>
        </div>
        <div class="text-grey-m2">
            <div class="my-1">
                Numero/Numéro: {{ service.list[0].numero }}
            </div>
            <div class="my-1">
                Client/Customer: {{service.list[0].client}}
            </div>
            <div class="my-1"><b class="text-600">Norme/Standard: {{ service.list[0].norme }}</b></div>
        </div>
    </div>
    <div class="col-sm-6" style=" text-align: center;">
      <div>
          <span class="text text-grey-m2 align-middle">Puissance/Power:</span>
          <span class="text-600 text-110 text-blue align-middle"> {{ service.list[0].power }} KVA</span>
      </div>
      <div class="text-grey-m2">
          <div class="my-1">
              MT:U1/MV:V1: {{ service.list[0].mtu1 }} KV
          </div>
          <div class="my-1">
              MT:I1/MV:I1: {{ service.list[0].mtu2 .toFixed(3)}} A
          </div>
          <div class="my-1">
            BT:U2/LV:V2: {{ service.list[0].btu2 }} V
        </div>
          <div class="my-1"><b class="text-600">BT:I2/LV:I2: {{ service.list[0].bti2.toFixed(3) }} A</b></div>
      </div>
  </div>
  <div class="col-sm-6" style=" text-align: right;">
    <div>
        <span> <strong>CE-FOR-20-V<input placeholder="6" [(ngModel)]="pv[0].version" type="number"
          style="border: none;
          padding-left: 1px;
          outline: none;
          background: none;
          font-size: inherit;
          font-family: inherit;
          color: inherit;width: 2ch;"></strong></span><br>
        <span class="text text-grey-m2 align-middle">Nbr des phases/Nb of phases:</span>
        <span class="text-600 text-110 text-blue align-middle">{{ service.list[0].nbphase }}</span>
    </div>
    <div class="text-grey-m2">
        <div class="my-1">
            Prises/Tapping: {{ service.list[0].prises }}
        </div>
        <div class="my-1">
            Couplage/Connection: {{ service.list[0].couplage }}
        </div>
        <div class="my-1">
          Refroidissement/Cooling: {{ service.list[0].cooling }}
      </div>
        <div class="my-1"><b class="text-600">Frequence/Frequency: {{ service.list[0].frequency }}Hz</b></div>
    </div>
</div>
</div>
</div>
  <div class="invoice-body printing7" style="margin-left: -29px;">
    <div>
        <div class="panel panel-default">
          <div class="panel-heading  printing1">
            <h3 class="panel-title">Voltage Ratio / Rapport de transformation</h3>
            <small>{{ service.list[0].mtu1 }} V/ {{ service.list[0].btu2 }} V / {{ service.list[0].couplage }}</small>
          </div>

          <table class="table table-bordered table-condensed"  *ngIf="pv && pv.length > 0">
            <tbody>
              <tr>
                <td class="text-center colfix">Prises / Tappings</td>
                <td colspan="2" class="text-center colfix">Valeurs théorique / Thoeric values</td>
                <td colspan="3" class="text-center colfix">Valeurs mesurées/Messured values</td>
              </tr>
              <tr>
                <td class="text-center colfix">1</td>
                <td class="text-center colfix"><input class="text-center colfix" type="number" readonly [value]="this.pv[0].vt11?.toFixed(3)"></td>
                <td class="text-center colfix"><input class="text-center colfix" type="number" readonly [value]="this.pv[0].vt12?.toFixed(3)"></td>
                <td class="text-center colfix">
                  <input #input1 (keydown.enter)="input2.focus()" class="text-center colfix" type="number" [(ngModel)]="pv[0].vm11">
                </td>
                <td class="text-center colfix">
                  <input #input2 (keydown.enter)="input3.focus()" class="text-center colfix" type="number" [(ngModel)]="pv[0].vm12">
                </td>

                <td class="text-center colfix"><input #input3 (keydown.enter)="input4.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].vm13"></td>
              </tr>
              <tr>
                <td class="text-center colfix">2</td>
                <td class="text-center colfix"><input class="text-center colfix" type="number" readonly [value]="this.pv[0].vt21?.toFixed(3)"></td>
                <td class="text-center colfix"><input class="text-center colfix" type="number" readonly [value]="this.pv[0].vt22?.toFixed(3)"></td>
                <td class="text-center colfix"><input #input4 (keydown.enter)="input5.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].vm21"></td>
                <td class="text-center colfix"><input #input5 (keydown.enter)="input6.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].vm22"></td>
                <td class="text-center colfix"><input #input6 (keydown.enter)="input7.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].vm23"></td>
              </tr>
              <tr>
                <td class="text-center colfix">3</td>
                <td class="text-center colfix"><input class="text-center colfix" type="number" readonly [value]="this.pv[0].vt31?.toFixed(3)"></td>
                <td class="text-center colfix"><input class="text-center colfix" type="number" readonly [value]="this.pv[0].vt32?.toFixed(3)"></td>
                <td class="text-center colfix"><input #input7 (keydown.enter)="input8.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].vm31"></td>
                <td class="text-center colfix"><input #input8 (keydown.enter)="input9.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].vm32"></td>
                <td class="text-center colfix"><input #input9 (keydown.enter)="input10.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].vm33"></td>
              </tr>
              <tr>
                <td class="text-center colfix">4</td>
                <td class="text-center colfix"><input class="text-center colfix" type="number" readonly [value]="this.pv[0].vt41?.toFixed(3)"></td>
                <td class="text-center colfix"><input class="text-center colfix" type="number" readonly [value]="this.pv[0].vt42?.toFixed(3)"></td>
                <td class="text-center colfix"><input #input10 (keydown.enter)="input11.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].vm41"></td>
                <td class="text-center colfix"><input #input11 (keydown.enter)="input12.focus()"  class="text-center colfix" type="number"[(ngModel)]="pv[0].vm42"></td>
                <td class="text-center colfix"><input #input12 (keydown.enter)="input13.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].vm43"></td>
              </tr>
              <tr>
                <td class="text-center colfix">5</td>
                <td class="text-center colfix"><input class="text-center colfix" type="number" readonly [value]="this.pv[0].vt51?.toFixed(3)"></td>
                <td class="text-center colfix"><input class="text-center colfix" type="number" readonly [value]="this.pv[0].vt52?.toFixed(3)"></td>
                <td class="text-center colfix"><input #input13 (keydown.enter)="input14.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].vm51"></td>
                <td class="text-center colfix"><input #input14 (keydown.enter)="input15.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].vm52"></td>
                <td class="text-center colfix"><input #input15 (keydown.enter)="focusInput16()" class="text-center colfix" type="number"[(ngModel)]="pv[0].vm53"></td>
              </tr>
              <tr></tr>
            </tbody>
          </table>
        </div>

        <div class="panel panel-default" >
          <div class="panel-heading">
            <h3 class="panel-title">Resistence Mesurement / Mesure des resistances</h3>
          </div>
          <table class="table table-bordered table-condensed" *ngIf="pv && pv.length > 0">
            <tbody>
              <tr>
                <td colspan="2" class="text-center colfix">Winding Enrolement</td>
                <td class="text-center colfix">R[ohm]</td>
                <td class="text-center colfix">T</td>
              </tr>
              <tr>
                <td rowspan="3" class="text-center colfix">LV/BT</td>
                <td class="text-center colfix">N-a</td>
                <td class="text-center colfix"><input #input16 (keydown.enter)="input17.focus()"  class="text-center colfix" type="number"[(ngModel)]="pv[0].na0"></td>
                <td rowspan="6" class="text-center colfix"><input #input17 (keydown.enter)="input18.focus()" class="text-center colfix" type="number" [(ngModel)]="pv[0].temp"></td>
              </tr>
              <tr>
                <td class="text-center colfix">N-b</td>
                <td class="text-center colfix"><input #input18 (keydown.enter)="input19.focus()" class="text-center colfix" type="number" [(ngModel)]="pv[0].nb0"></td>
              </tr>
              <tr>
                <td class="text-center colfix">N-c</td>
                <td class="text-center colfix"><input #input19 (keydown.enter)="input20.focus()" class="text-center colfix" type="number" [(ngModel)]="pv[0].nc0"></td>
              </tr>
              <tr>
                <td rowspan="3" class="text-center colfix">MV/MT</td>
                <td class="text-center colfix">N-A</td>
                <td class="text-center colfix"><input #input20 (keydown.enter)="input21.focus()" class="text-center colfix" type="number" [(ngModel)]="pv[0].na1"></td>
              </tr>
              <tr>
                <td class="text-center colfix">N-B</td>
                <td class="text-center colfix"><input #input21 (keydown.enter)="input22.focus()" class="text-center colfix" type="number" [(ngModel)]="pv[0].nb2"></td>
              </tr>
              <tr>
                <td class="text-center colfix">N-C</td>
                <td class="text-center colfix"><input  #input22 (keydown.enter)="focusInput23()" class="text-center colfix" type="number" [(ngModel)]="pv[0].nc3"></td>
              </tr>
            </tbody>
          </table>
        </div>
</div>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">No load test / Essais a vide</h3>
      </div>
      <table class="table table-bordered table-condensed" *ngIf="pv && pv.length > 0">
        <tbody>
          <tr>
            <td></td>
            <td colspan="2" class="text-center colfix">Guaranteed values / valeurs garanties
      </td>
            <td colspan="4" class="text-center colfix">Mesured values / Valeurs mesurées
      </td>
          </tr>
          <tr>
            <td class="text-center colfix">Tapping / Prises</td>
            <td class="text-center colfix">Wo [w]</td>
            <td class="text-center colfix">Io [%]</td>
            <td class="text-center colfix">U [V]</td>
            <td class="text-center colfix">Io [A]</td>
            <td class="text-center colfix">Wo [W]</td>
            <td class="text-center colfix">Io[%]</td>
          </tr>
          <tr>
            <td class="text-center colfix"><input class="text-center colfix" type="number" [(ngModel)]="pv[0].tappings" name="tappings max=6"></td>
            <td class="text-center colfix"><input #input23 (keydown.enter)="input24.focus()"  class="text-center colfix" type="number" [(ngModel)]="pv[0].wog"></td>
            <td class="text-center colfix"><input #input24 (keydown.enter)="input25.focus()" class="text-center colfix" type="number" [(ngModel)]="pv[0].iog"></td>
            <td class="text-center colfix"><input class="text-center colfix" type="number" [(ngModel)]="this.service.list[0].btu2" readonly></td>
            <td class="text-center colfix" *ngIf="this.service.list[0].type==='Triphasés'" ><input  class="text-center colfix" type="number" [value]="pv[0].iom" readonly (click)="this.showDialog2()" ></td>
            <td class="text-center colfix" *ngIf="this.service.list[0].type!=='Triphasés'" ><input  class="text-center colfix" type="number" [(ngModel)]="pv[0].iom" ></td>
            <td class="text-center colfix"><input class="text-center colfix" type="number" #input25 (keydown.enter)="focusInput26()" [(ngModel)]="pv[0].wom"></td>
            <td class="text-center colfix"><input class="text-center colfix" type="number" [value]="this.getIOPourcentageMesurees().toFixed(3)" readonly></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Load test / Essais en charge</h3>
      </div>
      <table class="table table-bordered table-condensed">
        <tbody>
          <tr>
            <td></td>
            <td colspan="2" class="text-center colfix">Guaranteed values / valeurs garanties	</td>
            <td colspan="5" class="text-center colfix">Mesured values / Valeurs mesurées
      </td>
          </tr>
          <tr>
            <td class="text-center colfix">Tapping / Prises</td>
            <td class="text-center colfix">ZCC [%]</td>
            <td class="text-center colfix">WCC [W]</td>
            <td class="text-center colfix">T [C]</td>
            <td class="text-center colfix">Ucc [V]</td>
            <td class="text-center colfix">I [A]</td>
            <td class="text-center colfix">Wcc [W]</td>
            <td class="text-center colfix">Zcc [%]</td>
          </tr>
          <tr>
            <td class="text-center colfix"><input class="text-center colfix" type="number"[(ngModel)]="pv[0].tappings"></td>
            <td class="text-center colfix"><input  #input26 (keydown.enter)="input27.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].zccg"></td>
            <td class="text-center colfix"><input  #input27 (keydown.enter)="input28.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].wccg"></td>
            <td class="text-center colfix"><input  class="text-center colfix" type="number"[(ngModel)]="pv[0].temp"></td>
            <td class="text-center colfix"><input  #input28 (keydown.enter)="input29.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].uccm"></td>
            <td class="text-center colfix"><input  class="text-center colfix" type="number"[(ngModel)]="this.service.list[0].mtu2"></td>
            <td class="text-center colfix">
              <input  (ngModelChange)="getZcc2()" #input29 (keydown.enter)="focusInput30()" class="text-center colfix" type="number" [(ngModel)]="pv[0].wccm1">
            </td>

           <td class="text-center colfix"><input class="text-center colfix" type="number" [value]="this.getZccPourcentage().toFixed(3)" readonly></td>

          </tr>
          <tr>
            <td colspan="6" class="text-right colfix">values at 75° / Valeurs à 75°
      </td>
            <td class="text-center colfix" ><input title="Cliquez pour afficher la fiche de calcul"  tooltipPosition="bottom" class="text-center colfix"  label="Show"  type="number"[value]="this.wcc2.toFixed(3)" readonly></td>
            <td class="text-center colfix"><input title="Cliquez pour afficher la fiche de calcul"   tooltipPosition="bottom" class="text-center colfix" label="Show" type="number"[value]="this.Zcc2.toFixed(3)" readonly></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Dielectric test / Essais diélectrique</h3>
      </div>
      <table class="table table-bordered table-condensed" *ngIf="pv && pv.length">
        <tbody>
          <tr>
            <td class="text-left colfix" style="width: 200px;">Induced voltage test at / Essai par tension induite a 150 Hz</td>
            <td class="text-center colfix">U [V]</td>
            <td class="text-center colfix"><input #input30 (keydown.enter)="input31.focus()" class="text-center colfix" type="number" [(ngModel)]="pv[0].u1"></td>
            <td class="text-center colfix"><input #input31 (keydown.enter)="input32.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].t1"></td>
          </tr>
          <tr>
            <td class="text-left colfix" style="width: 200px;">Applied voltage test (HV) at / Essai par tension appliqueés (HT) a 50Hz</td>
            <td class="text-center colfix">U [kV]</td>
            <td class="text-center colfix"><input #input32 (keydown.enter)="input33.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].u2"></td>
            <td class="text-center colfix"><input #input33 (keydown.enter)="input34.focus()"class="text-center colfix" type="number"[(ngModel)]="pv[0].t2"></td>
          </tr>
          <tr>
            <td class="text-left colfix" style="width: 200px;">Applied voltage test (LV) at / Essai par tension appliqueés (BT) a 50Hz</td>
            <td class="text-center colfix">U [kV]</td>
            <td class="text-center colfix"><input  #input34 (keydown.enter)="input35.focus()" class="text-center colfix" type="number"[(ngModel)]="pv[0].u3"></td>
            <td class="text-center colfix"><input  #input35  class="text-center colfix" type="number"[(ngModel)]="pv[0].t3"></td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>
  <div class="row" style="display: contents;">
    <div>

  <div class="invoice-footer printing8">
    <div style="display: flex; justify-content: space-between;">
      <strong style="text-align: left;">Customer <br> Client<br> {{service.list[0].client}}</strong>
      <strong style="text-align: center;">R.Laboratory <br> R.Loborataire <br> {{pv[0].controleurDeQualite?.username}} </strong>
      <strong style="text-align: right;">R. Technical <br>R.Technique<br> {{pv[0].technique}} </strong>
  </div>
      <hr style="border-color: #51121E; border-width: 5px; height: 10px;" class="printing5">
    <br/>
      <strong>Direction commerciale :</strong>Immeuble l'Express-Centre Nord 2eme Etage- Appt A2-7 Tunis 1082 Tél : 00 216 71 822 503 Fax : 00 216 71 822 515
      <br><strong>Siege Social & Usine </strong>Rue Avicenne -2021 OUED ELLIL-TUNISIE Tél : 216 71 629 664 Fax : +216 71 629 664 Fax : +216 71 629 551
      <br>Web : www.ttransfo.com / E-Mail : info&#64;ttransfo.com
  </div>
</div>
<div class="page-tools" style="padding-left: 136vh;" class="printable">
  <div class="action-buttons" style="display: flex;">
    <a class="btn bg-white btn-light mx-1px text-95" data-title="Print" (click)="onPrint()">
      <i class="mr-1 fa fa-print text-primary-m1 text-120 w-2"></i>
      <span style="padding-left: 8px;">Print</span>
    </a>
    <a  class="btn bg-white btn-light mx-1px text-95" (click)="savePvValues();getZcc2()" data-title="Save">
    <i class="mr-1 fa fa-save text-success-m1 text-120 w-2"></i>
      <span style="padding-left: 8px;" *ngIf="ServiceS.Controleur.designation==='Verificateur' ">Verifier</span>
      <span style="padding-left: 8px;" *ngIf="ServiceS.Controleur.designation==='Controleur' ">Save</span>
    </a>
  </div>
</div>
</div>

<p-dialog (onHide)="this.isHoverDisabled = false"  [modal]="true" header="Fiche de Calcul" [(visible)]="visible"  [maximizable]="true" [style]="{ width: '50vw' }" [draggable]="true" [resizable]="true">

  <div style="padding-left: 5px;">
<div class="info-section">
  <div class="info-item">Ibt: 1 A</div>
  <div class="info-item">Iht: 1 A</div>
  <div class="info-item" style="white-space: nowrap;">CC 1 : {{cc.toFixed(3)}}</div>
  <div class="info-item" style="white-space: nowrap;">CC 2 : {{cc.toFixed(3)}}</div>

  <div class="info-item">Norme: {{ this.service.list[0].norme }}</div>
  <div class="info-item">Type: {{ this.service.list[0].type }}</div>
  <div class="info-item">Libelle: {{ this.service.list[0].libelle }}</div>

</div>

<div style="display: contents;" *ngIf="this.service.list[0].libelle === 'Cuivre'">
  <div class="panel panel-default" style="width: fit-content; margin-right: auto;">
    <div class="panel-heading">
                      <h3 class="panel-title">Partie 1</h3>
                    </div>
   <table class="table table-bordered table-condensed">
    <tbody>
        <tr>
            <td class="text-left colfix">N</td>
            <td class="text-center colfix">Ref Transfo</td>
            <td class="text-center colfix">UAB (V)</td>
            <td class="text-center colfix">RAB (ohm) T0</td>
            <td class="text-center colfix">RAB (ohm) T0(cc)</td>
            <td class="text-center colfix">RAB (ohm)</td>
            <td class="text-center colfix">UAC (V)</td>
            <td class="text-center colfix">RAC (ohm) T0</td>
            <td class="text-center colfix">RAC (ohm) T0(cc)</td>
            <td class="text-center colfix">RAC (ohm)</td>
            <td class="text-center colfix">UBC (V)</td>
            <td class="text-center colfix">RBC (ohm) T0</td>
            <td class="text-center colfix">RBC (ohm) T0(cc)</td>
            <td class="text-center colfix">Ua (V)</td>
            <td class="text-center colfix">Ra (ohm) T0</td>
            <td class="text-center colfix">Ra (ohm) T0(cc)</td>
            <td class="text-center colfix">Ra (ohm)</td>
            <td class="text-center colfix">Ub</td>
            <td class="text-center colfix">Rb (ohm) T0</td>
            <td class="text-center colfix">Rb (ohm) T0(cc)</td>
            <td class="text-center colfix">Rb (ohm)</td>
            <td class="text-center colfix">Uc</td>
            <td class="text-center colfix">Rc (ohm) T0</td>
            <td class="text-center colfix">Rc (ohm) T0(cc)</td>
            <td class="text-center colfix">Rc (ohm)</td>
        </tr>
        <tr>
          <td class="text-left colfix">1</td>
          <td class="text-center colfix">{{ this.service.list[0].numero }}</td>
          <td class="text-center colfix">{{ UAB?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RABohmT0?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RABohmT0cc?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RABohm?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ UAC?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RACohmT0?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RACohmT0cc?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RACohm?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ UBC?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RBCohmT0?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RBCohmT0cc?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ Ua?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RaohmTo?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RaohmT0cc?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ Raohm?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ Ub?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RbohmTo?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RbohmT0cc?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ Rbohm?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ Uc?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RcohmTo?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ RcohmT0cc?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ Rcohm?.toFixed(4) }}</td>
      </tr>
    </tbody>
  </table>
  </div>
  <div class="panel panel-default" style="width: fit-content;margin-top: 5vh;">
    <div class="panel-heading">
      <h3 class="panel-title">Partie 2</h3>
    </div>
    <table class="table table-bordered table-condensed">
      <tbody>
        <tr>
          <td class="text-left colfix">N</td>
          <td class="text-center colfix">Ref Transfo</td>
          <td class="text-center colfix">Io (A)</td>
          <td class="text-center colfix">Io (%)</td>
          <td class="text-center colfix">Po (W)</td>
          <td class="text-center colfix">Ucc T0 (V)</td>
          <td class="text-center colfix">Ucc T0 (%)</td>

          <td class="text-center colfix">Pcc T0cc (W)</td>
          <td class="text-center colfix">Ur T0 (%)</td>
          <td class="text-center colfix">Ux (%)</td>
          <td class="text-center colfix">Ur (%)</td>
          <td class="text-center colfix">Ucc (%)</td>


          <td class="text-center colfix">Pj(HT)T0 (W)</td>
          <td class="text-center colfix">Pj(HT)T0cc (W)</td>
          <td class="text-center colfix">Pj(BT)To (W)</td>
          <td class="text-center colfix">Pj(BT)T0cc (W)</td>
          <td class="text-center colfix">PaddTocc</td>
          <td class="text-center colfix">Pj(HT) (W)</td>
          <td class="text-center colfix">Pj(BT) (W)</td>
          <td class="text-center colfix">Padd (W)</td>
          <td class="text-center colfix">PCC (W)</td>
        </tr>
        <tr>
          <td class="text-left colfix">1</td>
          <td class="text-center colfix">{{ this.service.list[0].numero }}</td>
          <td class="text-center colfix">{{ this.pv[0].iom }}</td>
          <td class="text-center colfix">{{ this.getIOPourcentageMesurees().toFixed(3) }}</td>

          <td class="text-center colfix">{{ Po?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ UccT0?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ UccT0Pourcentage?.toFixed(4) }}</td>

          <td class="text-center colfix">{{ this.pv[0] && this.pv[0].wccm1 !== undefined ? this.pv[0].wccm1?.toFixed(4) : 'N/A' }}</td>
          <td class="text-center colfix">{{this.UrT0?.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.Ux?.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.Ur.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.Zcc2?.toFixed(4)}}</td>

          <td class="text-center colfix">{{ PjhTo?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ PjhtT0cc?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ PjbTo?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ PjbT0cc?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ PaddTo?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ Pjht?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ Pjbt?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ Padd?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ wcc2?.toFixed(4)}}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>



<div style="display: contents;" *ngIf="this.service.list[0].libelle==='Aluminum' ">
  <div class="panel panel-default" style="width: fit-content; margin-right: auto;">
    <div class="panel-heading">
                      <h3 class="panel-title">Partie 1</h3>
                    </div>
   <table class="table table-bordered table-condensed">
    <tbody>
        <tr>
            <td class="text-left colfix">N</td>
            <td class="text-center colfix">Ref Transfo</td>
            <td class="text-center colfix">UA (V)</td>
            <td class="text-center colfix">RA (ohm) T0</td>
            <td class="text-center colfix">RA (ohm)</td>
            <td class="text-center colfix">UB (V)</td>
            <td class="text-center colfix">RB (ohm) T0</td>
            <td class="text-center colfix">RB (ohm)</td>
            <td class="text-center colfix">UC (V)</td>
            <td class="text-center colfix">RC (ohm) T0</td>
            <td class="text-center colfix">RC (ohm)</td>
            <td class="text-center colfix">Ua (V)</td>
            <td class="text-center colfix">Ra (ohm) T0</td>
            <td class="text-center colfix">Ra (ohm)</td>
            <td class="text-center colfix">Ub (V)</td>
            <td class="text-center colfix">Rb (ohm) T0</td>
            <td class="text-center colfix">Rb (ohm)</td>
            <td class="text-center colfix">Uc (V)</td>
            <td class="text-center colfix">Rc (ohm) T0</td>
            <td class="text-center colfix">Rc (ohm)</td>
        </tr>
        <tr>
          <td class="text-left colfix">1</td>
          <td class="text-center colfix">{{this.service.list[0].numero}}</td>
          <td class="text-center colfix">{{this.UAB.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.RAohmT0.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.RAohm.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.UAC.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.RBohmT0.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.RBohm.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.UBC.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.RCohmT0.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.RCohm.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.Ua}}</td>
          <td class="text-center colfix">{{this.RaohmT0.toFixed(6)}}</td>
          <td class="text-center colfix">{{this.Raohm.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.Ub}}</td>
          <td class="text-center colfix">{{this.RbohmT0.toFixed(6)}}</td>
          <td class="text-center colfix">{{this.Rbohm.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.Uc}}</td>
          <td class="text-center colfix">{{this.RcohmT0.toFixed(6)}}</td>
          <td class="text-center colfix">{{this.Rcohm.toFixed(4)}}</td>
      </tr>
    </tbody>
  </table>
  </div>
  <div class="panel panel-default" style="width: fit-content;margin-top: 5vh;">
    <div class="panel-heading">
      <h3 class="panel-title">Partie 2</h3>
    </div>
    <table class="table table-bordered table-condensed">
      <tbody>
        <tr>
          <td class="text-left colfix">N</td>
          <td class="text-center colfix">Ref Transfo</td>
          <td class="text-center colfix">Io (A)</td>
          <td class="text-center colfix">Io (%)</td>
          <td class="text-center colfix">Po (W)</td>
          <td class="text-center colfix">Ucc T0 (V)</td>
          <td class="text-center colfix">Ucc T0 (%)</td>

          <td class="text-center colfix">Pcc T0 (W)</td>
          <td class="text-center colfix">Ur T0 (%)</td>
          <td class="text-center colfix">Ux (%)</td>
          <td class="text-center colfix">Ur (%)</td>
          <td class="text-center colfix">Ucc (%)</td>


          <td class="text-center colfix">Pj(HT)T0 (W)</td>
          <td class="text-center colfix">Pj(BT)To (W)</td>
          <td class="text-center colfix">PaddTo (W)</td>
          <td class="text-center colfix">Pj(HT) (W)</td>
          <td class="text-center colfix">Pj(BT) (W)</td>
          <td class="text-center colfix">Padd (W)</td>
          <td class="text-center colfix">PCC (W)</td>
          <td class="text-center colfix">PTO (W)</td>

        </tr>
        <tr>
          <td class="text-left colfix">1</td>
          <td class="text-center colfix">{{ this.service.list[0].numero }}</td>
          <td class="text-center colfix">{{ this.pv[0].iom }}</td>
          <td class="text-center colfix">{{ this.getIOPourcentageMesurees().toFixed(3) }}</td>

          <td class="text-center colfix">{{ Po?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ UccT0?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ UccT0Pourcentage?.toFixed(4) }}</td>

          <td class="text-center colfix">{{ this.pv[0] && this.pv[0].wccm1 !== undefined ? this.pv[0].wccm1?.toFixed(4) : 'N/A' }}</td>
          <td class="text-center colfix">{{this.UrT0?.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.Ux?.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.Ur?.toFixed(4)}}</td>
          <td class="text-center colfix">{{this.Zcc2?.toFixed(4)}}</td>

          <td class="text-center colfix">{{ PjhTo?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ PjbTo?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ PaddTo?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ Pjht?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ Pjbt?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ Padd?.toFixed(4) }}</td>
          <td class="text-center colfix">{{ wcc2?.toFixed(4)}}</td>
          <td class="text-center colfix">{{ PTOT?.toFixed(4)}}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>


  </div>
</p-dialog>

<p-sidebar (onHide)="this.isHoverDisabled = false"  [(visible)]="sidebarVisible1" position="left">
  <ng-template pTemplate="header"><h3 class="card-title" style="white-space: nowrap;color: black;">Historique</h3></ng-template>
  <ng-template pTemplate="content">
    <h5 style="white-space: nowrap;" >Rapport de transformation : {{this.ValidateEssais()}}</h5>
    <h5 style="white-space: nowrap;">Mesure des resistances : {{this.ValidateEssais2()}}</h5>
    <h5 style="white-space: nowrap;">Essais a vide : En Attente</h5>
    <h5 style="white-space: nowrap;">Essais en charge : En Attente</h5>
    <h5 style="white-space: nowrap;">Essais diélectrique : En Attente</h5>
  </ng-template>
  <ng-template pTemplate="footer" [ngStyle]="{'color': this.pv[0].resultat === 'En Attente' ? '#666' : '#333'}">
    <span style="font-weight: bold;">Résultat final: </span>
    <span>{{ this.pv[0].resultat }}</span>
  </ng-template>

  </p-sidebar>
  <p-dialog   (onHide)="isHoverDisabled = false;" [modal]="true" [(visible)]="visible4" [breakpoints]="{'960px': '75vw'}" [style]="{'width': '50vw'}" [draggable]="false" [resizable]="false">
    <ng-template pTemplate="header">
      <div class="custom-header" style="padding-left: 1vh;" >
        <!-- Your custom header content goes here -->
        <h5><i class="fas fa-bolt"></i> Calculer Io [A]</h5>
      </div>
    </ng-template>
    <div>
      <div>
      </div>
        <div class="modal-body">
          <div class="form-group">
            <input #input1 (keydown.enter)="input2.focus()" [(ngModel)]="IA"  class="form-control" placeholder="Saisir Ia">
          </div>
          <div class="form-group">
            <input #input2 (keydown.enter)="input3.focus()" [(ngModel)]="IB" class="form-control" placeholder="Saisir Ib">
          </div>
          <div class="form-group">
            <input #input3 [(ngModel)]="IC" class="form-control" placeholder="Saisir Ic">
          </div>
          <div class="form-group d-flex justify-content-end" (click)="CalculateI0();isHoverDisabled = false;this.visible4=false; ">
            <span  class="badge badge-success" style="cursor: pointer; background-color: #122151;">Sauvegarder</span>
          </div>
        </div>
    </div>
  </p-dialog>

